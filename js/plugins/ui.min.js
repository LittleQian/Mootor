(function(i){var B={radio:'<div moo-template="foreach: input"><div class="moo-ui-radio"><label><span class="moo-ui-radio-label" moo-template="text: this.label"></span><span class="moo-ui-radio-icon"> &nbsp;</span></label></div></div>',checkbox:'<div moo-template="foreach: input"><div class="moo-ui-checkbox"><label><span class="moo-ui-checkbox-label" moo-template="html: this.label"></span><span class="moo-ui-checkbox-icon"> &nbsp;</span></label></div></div>',overlay:"<div class='moo-overlay'></div>",loading:"<div class='moo-ui-loading'><div class='moo-ui-loading-block moo-loading-01'></div><div class='moo-ui-loading-block moo-loading-02'></div><div class='moo-ui-loading-block moo-loading-03'></div><div class='moo-ui-loading-block moo-loading-04'></div><div class='moo-ui-loading-block moo-loading-05'></div><div class='moo-ui-loading-block moo-loading-06'></div><div class='moo-ui-loading-block moo-loading-07'></div><div class='moo-ui-loading-block moo-loading-08'></div></div>",modal:"<div class='moo-ui-modal-container'><div class='moo-ui-modal-panel' moo-template='html: this.html'></div></div>",toggleswitch:"<div class='moo-ui-switch'><b><span class='moo-before'>I</span><span class='moo-button'>&nbsp;</span><span class='moo-after'>O</span></b></div>",text:'<span class="cleanbox">&times</span>',select:'<div class="moo-ui-select-container"><span class="moo-ui-select-text"></span><span class="moo-ui-select-link"> </span></div>',camera:"<div class='moo-ui-image-container'><div class='moo-ui-image-panel'><ul class='moo-image-list'><li class='moo-image-wrapper'><div class='moo-image'></div></li></ul></div><header><a class='moo-ui-add-new' href='#takepic'>Take a picture</a><a class='moo-ui-add-filed' href='#choosepic'>Choose a picture</a><a class='moo-ui-delete' href='#delete'></a><a class='moo-ui-add-comment' href='#addcomment'></a></header></div>"},r=function(D){return D.split(" ").join("")},C=function(L){var J=L.template,K=L.self,D=[],G=document.createElement("div"),I=[],E=0,H=[],F;G.innerHTML=J;I=G.getElementsByTagName("*");for(E=I.length;E--;){if(I[E].getAttribute("moo-template")!==null){H=r(I[E].getAttribute("moo-template")).split(":");D.push({el:I[E],key:H[0],value:H[1]})}if((F=I[E].getAttribute("moo-foreach-index"))!==null){D[E].index=F}}if(d(D)===true){for(E=D.length;E--;){if(D[E].key==="foreach"){p(D[E],K)}}}else{for(E=D.length;E--;){switch(D[E].key){case"text":f(D[E],K);break;case"html":g(D[E],K);break}}}return G.innerHTML},d=function(E){var D;for(D=E.length;D--;){if(E[D].key==="foreach"){return true}}return false},p=function(D,L){var N=D.value,H=L.input.getElementsByTagName(N),E=0,M={},F=D.el.innerHTML,I=[],K,G=[],J=document.createElement("div");L.items=[];I=i(L.input).find(N);if(N==="input"){G=i(L.input).find("label")}for(E=0;E<I.length;E++){L.items.push({el:I[E],text:I[E].innerText});K=L.items[L.items.length-1];if(N==="input"){K.label=G[E]}if(K.el.value!==undefined){K.value=K.el.value}}D.el.innerHTML="";for(E=0;E<H.length;E++){M=document.createElement("div");M.innerHTML=F;M.firstChild.setAttribute("moo-foreach-index",E);M.firstChild.setAttribute("moo-foreach-value",L.items[E].value);M.innerHTML=C({template:M.innerHTML,self:L});J.appendChild(M.firstChild)}D.el.innerHTML=J.innerHTML},f=function(F,D){var E=F.index,H="",G="";if(F.value.indexOf("this.")>-1){H=F.value.replace("this.","");G=D.items[E][H];if(G!==undefined){if(typeof G==="string"){F.el.innerText=G}else{F.el.innerText=G.innerText}}}},g=function(F,D){var E=F.index,H="",G="";if(F.value.indexOf("this.")>-1){H=F.value.replace("this.","");G=D.items[E][H];if(typeof G==="string"){F.el.innerHTML=G}else{F.el.innerHTML=G.innerHTML}G.parentElement.removeChild(G)}};var o=function(){if(o.el===undefined){o._makeHTML({type:"overlay",object:o})}this.el=o.el;return this},c=function(){if(c.el===undefined){o._makeHTML({type:"modal",object:c})}this.el=c.el;return this},l=function(){if(l.el===undefined){o._makeHTML({type:"loading",object:l})}this.el=l.el;return this};l.prototype=o.prototype={show:function(){i(this.el).removeClass("moo-hidden")},hide:function(){i(this.el).setClass("moo-hidden")}};c.prototype={html:function(D){this.html=D;this.el.innerHTML=C({template:this.el.innerHTML,self:this})}};i.extend(o.prototype,c.prototype);i.extend({el:undefined,_makeHTML:function(E){var G=E.type,D=E.object,F=document.createElement("div");F.innerHTML=B[G];D.el=F.firstChild;i(D.el).setClass("moo-hidden");i(document.body).el.appendChild(D.el)}},o);var v=function(){};var t=function(D){this.input=D.el;i(this.input).hide();this._makeHTML();this._setTouchEvents();if(D.value){this.input.value=D.value}this.toggle(this.input.value);return this};t.prototype={_makeHTML:function(){var D;D=document.createElement("div");D.innerHTML=B.toggleswitch;this.el=D.firstChild;this.input.parentElement.appendChild(this.el)},_setTouchEvents:function(){var F=this,G=i(F.el).find("b")[0],D=F.el.offsetWidth-32,E=0;F.x=0;F.isDragging=0;i(this.el).onTapEnd(function(H){F.toggle()});i(this.el).onSwipeRight(function(H){F._swipe=1});i(this.el).onSwipeLeft(function(H){F._swipe=-1});i(this.el).onDragMove(function(H){var I=F.x+(H.x-H.lastX);F.isDragging=1;i(F.el).removeClass("moo-on");i(F.el).removeClass("moo-off");H.e.stopPropagation();if((I<=D)&&(I>-4)){F.x=I;i(G).translateFx({x:F.x,y:0},{transitionDuration:0})}});i(this.el).onDragEnd(function(H){H.e.stopPropagation();i(G).cleanFx();if(F._swipe!==0&&H.time<400){if(F._swipe===1){F.toggle(1)}else{F.toggle(0)}}else{if(F.isDragging===1){F.isDragging=0;if(F.x<(D/2)){F.toggle(0)}else{F.toggle(1)}}}})},toggle:function(E){var D=i(this.el);if(E!==undefined){this.value=+E}else{if(this.value===0){this.value=1}else{this.value=0}}if(this.value===0){D.removeClass("moo-on");D.setClass("moo-off")}else{D.removeClass("moo-off");D.setClass("moo-on")}this.input.value=this.value;if(typeof this.onChange==="function"){this.onChange()}},on:function(D,E){if(D==="change"){this.onChange=E}}};var s=function(D){var E=0,F=this.pseudoItems=[];this.input=D.el;this.value=[];i(this.input).hide();this._makeHTML();F=i(this.container).find("div");for(E=0;E<F.length;E++){this.pseudoItems.push({el:F[E],value:F[E].value,mooSelectIndex:E})}this._setTouchEvents();if(D.value!==undefined){this.selectByValue(D.value)}return this};s.prototype={_makeHTML:function(){this.el=document.createElement("div");this.el.innerHTML=C({template:B.checkbox,self:this});this.container=i(this.el).find("div")[0];this.input.parentElement.appendChild(this.el)},_setTouchEvents:function(){var D=this,E=0;for(E=0;E<this.pseudoItems.length;E++){i(this.pseudoItems[E].el).onTapEnd(function(I){var H=i(I.el),F=I.el.getAttribute("moo-foreach-index"),G=function(){if(H.hasClass("moo-active")){D.unselect(F)}else{D.select(F)}};if(i.context.userAgent==="android"){window.setTimeout(function(){G()},0)}else{G()}b(I)})}},select:function(D){if(this.value.indexOf(D)<0){this.value.push(D.toString());this.items[D].el.setAttribute("checked","checked");i(this.pseudoItems[D].el).setClass("moo-active");A(this)}},unselect:function(D){this.value.splice(this.value.indexOf(D),1);this.items[D].el.removeAttribute("checked","");i(this.pseudoItems[D].el).removeClass("moo-active");A(this)},unselectAll:function(){var D=0;for(D=this.items.length;D--;){this.unselect(D)}},selectByValue:function(F){var E,D;if(Object.prototype.toString.call(F)!=="[object Array]"){F=[F]}for(E=this.items.length;E--;){for(D=F.length;D--;){if(this.items[E].value===F[D]){i(this.pseudoItems[E].el).setClass("moo-active");this.select(E)}}}},onChange:function(D){if(m[this.input.id]===undefined){m[this.input.id]=[]}m[this.input.id].push(D)}};var m={},A;A=function(D){var E;if(m[D.input.id]!==undefined){for(E=m[D.input.id].length;E--;){m[D.input.id][E](D)}}};var u=function(D){var E=0,F=this.pseudoItems=[];this.input=D.el;i(this.input).hide();this._makeHTML();F=i(this.container).find("div");for(E=0;E<F.length;E++){this.pseudoItems.push({el:F[E],value:F[E].value,mooSelectIndex:E})}this._setTouchEvents();if(D.value!==undefined){this.selectByValue(D.value)}return this};u.prototype={_makeHTML:function(){this.el=document.createElement("div");this.el.innerHTML=C({template:B.radio,self:this});this.container=i(this.el).find("div")[0];this.input.parentElement.appendChild(this.el)},_setTouchEvents:function(){var D=this,E=0;for(E=0;E<this.pseudoItems.length;E++){i(this.pseudoItems[E].el).onTapEnd(function(F){b(F);D.select(F.el.getAttribute("moo-foreach-index"))})}},select:function(E){var D=this,F;for(F=0;F<D.pseudoItems.length;F++){i(D.pseudoItems[F].el).removeClass("moo-active");D.pseudoItems[F].el.removeAttribute("checked","checked")}i(D.pseudoItems[E].el).setClass("moo-active");this.value=this.items[E].value;this.selectedIndex=E;this.input.selectedIndex=E;this.items[this.selectedIndex].el.setAttribute("checked","checked")},selectByValue:function(E){var D;for(D=this.items.length;D--;){if(this.items[D].value===E){this.select(D)}}}};var q=function(D){var E=0,F=this.pseudoItems=[];this.y=0;this.input=D.el;this._visibility="hidden";this._makeHTML();this._setTouchEvents();F=i(this.input).find("option");for(E=0;E<F.length;E++){this.pseudoItems.push({el:F[E],mooSelectIndex:E})}if(D.value!==undefined){this.selectByValue(D.value)}this.select(0);return this};q.prototype={_makeHTML:function(){var F=document.createElement("div"),E=B.select,D=this.input.parentElement;F.innerHTML=C({template:E,self:this});this.el=F.firstChild;this.el.parentElement.insertBefore(this.input);D.appendChild(F);this.box=i(this.el).find(".moo-ui-select-menu")[0];this.textspan=i(this.el).find(".moo-ui-select-text")[0]},_setTouchEvents:function(){var D=this;i(this.input).onTapEnd(function(E){if(D._visibility!=="visible"){D.input.focus();D._visibility="visible"}});i(this.input).on("blur",function(){D._visibility="hidden"});i(this.input).on("change",function(){D.select(D.input.selectedIndex)});i(this.el).onDragStart(b)},select:function(E){var D=this;window.setTimeout(function(){i(D.box).hide();D._visibility="hidden"},100);this.value=this.pseudoItems[E].el.value;this.selectedIndex=E;this.input.selectedIndex=E;i(this.textspan).html(this.pseudoItems[E].el.innerText)},selectByValue:function(E){var D;for(D=this.pseudoItems.length;D--;){if(this.pseudoItems[D].el.value===E){this.select(D)}}}};var z=false,w=function(E){var D=this;this.el=this.input=E.el;if(E.value!==undefined){this.el.value=E.value}this.value=D.el.value;this._makeHTML();i(this.el).onDragStart(b);i(this.el).onTapEnd(function(F){F.el.focus();b(F)});i(this.cleanbox).onTapEnd(function(){D.clean()});this.el.onblur=function(){window.scrollTo(0,0)};return this};w.focused=false;w.prototype={_makeHTML:function(){var F,E=this.el.parentElement,D=this;this.cleanbox=document.createElement("div");this.cleanbox.innerHTML=B.text;F=document.createElement("div");i(F).setClass("moo-ui-text");F.appendChild(this.cleanbox);F.appendChild(this.input);i(this.input).on("keyup",function(G){D.value=D.input.value;if(typeof D.onChange==="function"){D.onChange()}});E.appendChild(F)},clean:function(){this.input.value="";this.input.focus()},on:function(D,E){if(D==="change"){this.onChange=E}}};var x=function(E){var D=this;this.el=this.input=E.el;if(E.value!==undefined){this.el.innerHTML=E.value}this.value=D.el.innerHTML;this._makeHTML();i(this.el).onDragStart(b);i(this.el).onTapEnd(function(F){F.el.focus();b(F)});return this};x.prototype={_makeHTML:function(){var F,E=this.el.parentElement,D=this;i(this.input).on("keyup",function(G){D.value=D.input.value});F=document.createElement("div");i(F).setClass("moo-ui-textarea");F.appendChild(this.input);E.appendChild(F)}};var k=function(D){this.input=D.el;this.position=D.position;this.count=0;k._makeHTML(D,this);k._setTouchEvents(this);k._initProperties(this,D);if(D.value!==undefined){this.value=D.value}else{this.value=[]}return this};k.prototype={show:function(){if(typeof this.onShowBox==="function"){this.onShowBox()}i(this.el).show();this._visibility="visible"},hide:function(){i(this.el).hide();this._visibility="hidden"},onShowBox:function(D){this.onShowBox=D},onCamera:function(D){this.onCamera=D},onSuccess:function(D){this.onSuccess=D},onFail:function(D){this.onFail=D},onChange:function(D){this.onChange=D},push:function(I){var D=document.createElement("div"),H,F=this,E,G;D.innerHTML=this.imageWrapper.outerHTML;E=i(D).find(".moo-image");H=E[0];H.setAttribute("moo-index",this.count);E=i(F.imageList).find("li");for(G=E.length;G--;){i(E[G].firstChild).removeClass("moo-active")}i(H).setClass("moo-active");F.itemSelected=this.count;i(H).onTapEnd(function(M){var L=i(M.el),K,J=i(F.imageList).find("li");if(L.hasClass("moo-active")===false){for(K=J.length;K--;){i(J[K].firstChild).removeClass("moo-active")}i(M.el).setClass("moo-active");F.itemSelected=M.el.getAttribute("moo-index")}});H.appendChild(I);this.value.push(I.getAttribute("src"));i(D.firstChild).show();this.imageList.appendChild(D.firstChild);i(this.el).removeClass("moo-empty");this.count++},clear:function(){var D=i(this.imageList).find("li"),E=0;for(E=D.length;E--;){this.imageList.removeChild(D[E])}this.count=0;this.value=[]},removeItem:function(E){var D=i(this.imageList).find("li"),F=0;console.log("remove item!");this.imageList.removeChild(D[F]);this.value.splice(E,1);this.count=D.length-1;if(typeof this.onChange==="function"){this.onChange(this,E)}i(D[this.count]).setClass("moo-active");this.itemSelected=this.count}};i.extend({_makeHTML:function(F,E){var G=document.createElement("div"),D;G.innerHTML=B.camera;E.el=G.firstChild;D=i(E.el);D.setClass("moo-empty");if(E.position==="top"){D.setClass("moo-top")}else{if(E.position==="bottom"){D.setClass("moo-bottom")}}E.takeButton=D.find(".moo-ui-add-new")[0];E.chooseButton=D.find(".moo-ui-add-filed")[0];if(F.labelTakeButton!==undefined){E.takeButton.innerHTML=F.labelTakeButton}if(F.labelChooseButton!==undefined){E.chooseButton.innerHTML=F.labelChooseButton}E.imageWrapper=D.find(".moo-image-wrapper")[0];E.imageList=D.find(".moo-image-list")[0];D.hide();E._visibility="hidden";E.input.appendChild(E.el);i(E.imageWrapper).hide()},_setTouchEvents:function(D){i(D.input).onTapEnd(function(){if(D._visibility==="hidden"){D.show()}else{D.hide()}});i(D.el).onTapEnd(function(){D.hide()});i(D.takeButton).onTapEnd(function(){k.camera(D)});i(D.chooseButton).onTapEnd(function(){k.camera(D,"album")})},_initProperties:function(D,E){D.quality=D.quality?D.quality:50;D.width=D.width?D.width:1024;D.height=D.height?D.height:768},camera:function(D,E){var F,G;if(typeof D.onCamera==="function"){D.onCamera()}if(D.disabled!==true){if(window.Camera!==undefined){if(E==="album"){F=window.Camera.PictureSourceType.SAVEDPHOTOALBUM}G=function(H){D.onSuccess(H)};navigator.camera.getPicture(G,D.onFail,{quality:D.quality,destinationType:window.Camera.DestinationType.FILE_URI,sourceType:F,targetWidth:D.width,targetHeight:D.height})}else{console.log("Not camera! using sample pic");D.onSuccess("img/temp/samplepic.jpg")}}}},k);var e=function(D){this.input=D.el;this.sourceType=D.sourceType;e._setTouchEvents(this);e._initProperties(this,D);if(D.value!==undefined){this.value=D.value}else{this.value=[]}return this};e.prototype={onCamera:function(D){this.onCamera=D},onSuccess:function(D){this.onSuccess=D},onFail:function(D){this.onFail=D},onChange:function(D){this.onChange=D},};i.extend({_setTouchEvents:function(D){if(D.sourceType==="album"){i(D.input).onTapEnd(function(){k.camera(D,"album")})}else{i(D.input).onTapEnd(function(){k.camera(D)})}},_initProperties:function(D,E){D.quality=D.quality?D.quality:50;D.width=D.width?D.width:1024;D.height=D.height?D.height:768},camera:function(D,E){var F,G;if(typeof D.onCamera==="function"){D.onCamera()}if(D.disabled!==true){if(window.Camera!==undefined){if(E==="album"){F=window.Camera.PictureSourceType.SAVEDPHOTOALBUM}G=function(H){D.onSuccess(H)};navigator.camera.getPicture(G,D.onFail,{quality:D.quality,destinationType:window.Camera.DestinationType.FILE_URI,sourceType:F,targetWidth:D.width,targetHeight:D.height})}else{console.log("Not camera! using sample pic");D.onSuccess("img/temp/samplepic.jpg")}}}},e);var h=function(E){var D=this;this.el=E.el;h._setTouchEvents(D);if(E.key!==undefined){D.key=E.key}else{D.key=""}D.onLoad=E.onLoad;h._includeScript(D.key,function(){h._API=google.maps;h._initProperties(D,E);h._initMap(D,E);if(typeof D.onLoad==="function"){D.onLoad()}return D})};h.prototype={addMarker:function(E){var D=new j(E,this.map);D.setMap(this);return this}};var j=function(E,G){var F,D=this;this.lat=E.lat;this.lon=E.lon;this.html=E.html;this._APIMarker=new h._API.Marker();this._APIMarker.setPosition(new h._API.LatLng(this.lat,this.lon));F=new h._API.InfoWindow({content:D.html});h._API.event.addListener(this._APIMarker,"click",function(){F.open(G,D._APIMarker)});return this};j.prototype={setMap:function(D){this._APIMarker.setMap(D.map)}};i.extend({_setTouchEvents:function(D){i(D.el).on("touchmove",function(E){E.stopPropagation()})},_initProperties:function(D,E){D.width=E.width?E.width:"100%";D.height=E.height?E.height:"100%";D.el.setAttribute("style","width:"+D.width+";height:"+D.height);D.zoom=E.zoom?E.zoom:13;D.center=E.center?E.center:[-34.599567,-58.372553];D.mapType=E.mapType?E.mapType:h._API.MapTypeId.ROADMAP},_includeScript:function(D,E){i._UIMapCallbacks=E;a(h._APIScript+"&key="+D)},_initMap:function(D){var E;E={zoom:D.zoom,center:new h._API.LatLng(D.center[0],D.center[1]),mapTypeId:D.mapType};D.map=new h._API.Map(D.el,E)},_APIScript:"https://maps.googleapis.com/maps/api/js?sensor=false&callback=$._UIMapCallbacks"},h);var a=function(D,F){var E=document.createElement("script");E.type="text/javascript";E.setAttribute("src",D);E.onload=F;document.body.appendChild(E)};var n=function(){};i.extend({ui:function(D){var E=n.get(this.query);if(E===undefined){D.el=this.el;switch(D.type){case"ToggleSwitch":E=new t(D);break;case"Text":E=new w(D);break;case"TextArea":E=new x(D);break;case"Select":E=new q(D);break;case"Radio":E=new u(D);break;case"Checkbox":E=new s(D);break;case"Camera":E=new k(D);break;case"SimpleCamera":E=new e(D);break;case"Map":E=new h(D);break}E.id=this.query;E.type=D.type;n.push(E);return E}else{return n.get(this.query)}}});var y={};i.extend({ui:{overlay:function(){return new o()},loading:function(){return new l()},modal:function(D){return new c()}}},i);i(document).ready(function(){var D=new o(),E=new l();i.extend({loadingScreen:{show:function(){D.show();E.show()},hide:function(){D.hide();E.hide()}}},i)});i.extend({_collection:[],get:function(E){var D;for(D=n._collection.length;D--;){if(n._collection[D].id===E){return n._collection[D]}}},push:function(D){this._collection.push(D)}},n);var b=function(D){D.e.stopPropagation();D.e.preventDefault()}}(Mootor));