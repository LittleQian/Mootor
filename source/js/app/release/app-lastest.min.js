(function(b){var a=function(e){a.init(e,this);return this},d=function(g,i){var h=this.el=g.el,f=this,e;if(g.el.id!==undefined){this.id=g.el.id}i.views.push(this);if(g.nav!==undefined){e=g.nav.get(this.id);e.onLoadContent=function(){if(f.cached===false){i.load(this,{nav:e})}}}this.cached=false;return this};a.prototype={load:function(e,g){var h=function(){},f="";if(g===undefined){g={}}if(g.callback!==undefined){h=g.callback}else{h=function(i){if(e.cached!==true){e.cached=true;if(g.el!==undefined){b(g.el).html(i)}else{b(e.el).html(i)}}if(g.nav!==undefined&&typeof g.nav.onLoadContentCallback==="function"){g.nav.onLoadContentCallback()}}}f=this.path+"/"+e.id+"/"+e.id;b.ajax({url:f+".html",callback:function(i){b.require(f+".js");h(i)}})},get:function(f){var e;for(e=this.views.length;e--;){if(this.views[e].id===f){return this.views[e]}}return null},data:{_collection:{},get:function(e){return this._collection[e]},set:function(e,f){this._collection[e]=f},unset:function(f){var e;for(e in this._collection){if(e===f){delete (this._collection[e])}}}}};b.extend({_collection:[],init:function(n,m){var g,h,e=window.location.href,j,k,f,l;if(n.id!==undefined){m.id=n.id}if(n.path!==undefined){m.path=n.path}else{m.path=""}m.views=[];if(n.views!==undefined){for(g=0;g<n.views.length;g++){j=new d({el:b("#"+n.views[g]).el,id:n.views[g],nav:n.nav},m)}}a._collection.push(m);if((h=e.lastIndexOf("#"))>-1){k=e.substring(h,e.length).replace("#","");if(k!==undefined){n.nav.set(k)}}},get:function(f){var e;for(e=a._collection.length;e--;){if(a._collection[e].id===f){return a._collection[e]}}},},a);b.extend({app:function(e){if(typeof e!=="object"){e={}}e.el=this.el;switch(e.type){default:return new a(e)}}},b);b.extend({app:function(e){return a.get(this.query)}});var c=function(e){this.model=e.model;if(e._localStoragePrefix!==undefined){e.localStoragePrefix=e.localStoragePrefix}this.localStoragePrefix=e.localStoragePrefix;return this};c.prototype={get:function(g){var e,f=this;g=this.localStoragePrefix+"-"+g;e=window.localStorage.getItem(g);if(e!==null){e=JSON.parse(e);b.extend({put:function(){f.put(this)}},e)}return e},filter:function(f){var k=this.all(),j,h,e=[],g=0;for(g in f){j=g}h=f[j];if(typeof h==="object"&&h.id!==undefined){h=h.id}for(g=k.length;g--;){if(k[g][j]===h){e.push(k[g])}}return e},create:function(l){var h=0,g="",f={},e,j=this.count(),k=this.localStoragePrefix;if(l.id===undefined){j++;l.id=j;for(h in l){if(typeof l[h]==="object"&&l[h].id!==undefined){f[h]=l[h].id}else{f[h]=l[h]}}}else{f=l}e=new this.model(f);g=JSON.stringify(e);window.localStorage.setItem(k+"-"+e.id,g);j=JSON.stringify({value:j});window.localStorage.setItem(k+"-count",j);return e},all:function(){var j=this.count(),e=[],g=0,h,f;if(j>0){for(g=0;g<=j;g++){f=this.get(g);if(f){e.push(f)}}}return e},put:function(f){var e=this.localStoragePrefix;window.localStorage.removeItem(e+"-"+f.id);return this.create(f)},count:function(){var f=this.localStoragePrefix,e=0;e=window.localStorage.getItem(f+"-count");if(e!==null){return JSON.parse(e).value}else{return 0}},remove:function(e){return null},};b.extend({Model:function(e){return new c(e)},models:{}},a.prototype)}(Mootor));