(function(i){var D={radio:'<div moo-template="foreach: input"><div class="moo-ui-radio"><label><span class="moo-ui-radio-label" moo-template="text: this.label"></span><span class="moo-ui-radio-icon"> &nbsp;</span></label></div></div>',checkbox:'<div moo-template="foreach: input"><div class="moo-ui-checkbox"><label><span class="moo-ui-checkbox-label" moo-template="html: this.label"></span><span class="moo-ui-checkbox-icon"> &nbsp;</span></label></div></div>',overlay:"<div class='moo-overlay'></div>",loading:"<div class='moo-ui-loading'><div class='moo-ui-loading-block moo-loading-01'></div><div class='moo-ui-loading-block moo-loading-02'></div><div class='moo-ui-loading-block moo-loading-03'></div><div class='moo-ui-loading-block moo-loading-04'></div><div class='moo-ui-loading-block moo-loading-05'></div><div class='moo-ui-loading-block moo-loading-06'></div><div class='moo-ui-loading-block moo-loading-07'></div><div class='moo-ui-loading-block moo-loading-08'></div></div>",modal:"<div class='moo-ui-modal-container'><div class='moo-ui-modal-panel' moo-template='html: this.html'></div></div>",toggleswitch:"<div class='moo-ui-switch'><b><span class='moo-before'>I</span><span class='moo-button'>&nbsp;</span><span class='moo-after'>O</span></b></div>",text:'<span class="cleanbox">&times</span>',select:'<div class="moo-ui-select-container"><span class="moo-ui-select-text"></span><span class="moo-ui-select-link"> </span></div>',uidate:'<div class="moo-ui-date-container"><span class="moo-ui-date-text"></span><span class="moo-ui-date-link"> </span></div>',uitime:'<div class="moo-ui-time-container"><span class="moo-ui-time-text"></span><span class="moo-ui-time-link"> </span></div>',camera:"<div class='moo-ui-image-container'><div class='moo-ui-image-panel'><ul class='moo-image-list'><li class='moo-image-wrapper'><div class='moo-image'></div></li></ul></div><header><a class='moo-ui-add-new' href='#takepic'>Take a picture</a><a class='moo-ui-add-filed' href='#choosepic'>Choose a picture</a><a class='moo-ui-delete' href='#delete'></a><a class='moo-ui-add-comment' href='#addcomment'></a></header></div>"},s=function(F){return F.split(" ").join("")},E=function(N){var L=N.template,M=N.self,F=[],I=document.createElement("div"),K=[],G=0,J=[],H;I.innerHTML=L;K=I.getElementsByTagName("*");for(G=K.length;G--;){if(K[G].getAttribute("moo-template")!==null){J=s(K[G].getAttribute("moo-template")).split(":");F.push({el:K[G],key:J[0],value:J[1]})}if((H=K[G].getAttribute("moo-foreach-index"))!==null){F[G].index=H}}if(d(F)===true){for(G=F.length;G--;){if(F[G].key==="foreach"){q(F[G],M)}}}else{for(G=F.length;G--;){switch(F[G].key){case"text":f(F[G],M);break;case"html":g(F[G],M);break}}}return I.innerHTML},d=function(G){var F;for(F=G.length;F--;){if(G[F].key==="foreach"){return true}}return false},q=function(F,N){var P=F.value,J=N.input.getElementsByTagName(P),G=0,O={},H=F.el.innerHTML,K=[],M,I=[],L=document.createElement("div");N.items=[];K=i(N.input).find(P);if(P==="input"){I=i(N.input).find("label")}for(G=0;G<K.length;G++){N.items.push({el:K[G],text:K[G].innerText});M=N.items[N.items.length-1];if(P==="input"){M.label=I[G]}if(M.el.value!==undefined){M.value=M.el.value}}F.el.innerHTML="";for(G=0;G<J.length;G++){O=document.createElement("div");O.innerHTML=H;O.firstChild.setAttribute("moo-foreach-index",G);O.firstChild.setAttribute("moo-foreach-value",N.items[G].value);O.innerHTML=E({template:O.innerHTML,self:N});L.appendChild(O.firstChild)}F.el.innerHTML=L.innerHTML},f=function(H,F){var G=H.index,J="",I="";if(H.value.indexOf("this.")>-1){J=H.value.replace("this.","");I=F.items[G][J];if(I!==undefined){if(typeof I==="string"){H.el.innerText=I}else{H.el.innerText=I.innerText}}}},g=function(H,F){var G=H.index,J="",I="";if(H.value.indexOf("this.")>-1){J=H.value.replace("this.","");I=F.items[G][J];if(typeof I==="string"){H.el.innerHTML=I}else{H.el.innerHTML=I.innerHTML}I.parentElement.removeChild(I)}};var o=function(){if(o.el===undefined){o._makeHTML({type:"overlay",object:o})}this.el=o.el;return this},c=function(){if(c.el===undefined){o._makeHTML({type:"modal",object:c})}this.el=c.el;return this},l=function(){if(l.el===undefined){o._makeHTML({type:"loading",object:l})}this.el=l.el;return this};l.prototype=o.prototype={show:function(){i(this.el).removeClass("moo-hidden")},hide:function(){i(this.el).setClass("moo-hidden")}};c.prototype={html:function(F){this.html=F;this.el.innerHTML=E({template:this.el.innerHTML,self:this})}};i.extend(o.prototype,c.prototype);i.extend({el:undefined,_makeHTML:function(G){var I=G.type,F=G.object,H=document.createElement("div");H.innerHTML=D[I];F.el=H.firstChild;i(F.el).setClass("moo-hidden");document.body.insertBefore(F.el,document.body.firstChild)}},o);var w=function(){};var u=function(F){this.input=F.el;i(this.input).hide();this._makeHTML();this._setTouchEvents();if(F.value){this.input.value=F.value}this.toggle(this.input.value);return this};u.prototype={_makeHTML:function(){var F;F=document.createElement("div");F.innerHTML=D.toggleswitch;this.el=F.firstChild;this.input.parentElement.appendChild(this.el)},_setTouchEvents:function(){var H=this,I=i(H.el).find("b")[0],F=H.el.offsetWidth-32,G=0;H.x=0;H.isDragging=0;i(this.el).onTapEnd(function(J){H.toggle()});i(this.el).onSwipeRight(function(J){H._swipe=1});i(this.el).onSwipeLeft(function(J){H._swipe=-1});i(this.el).onDragMove(function(J){var K=H.x+(J.x-J.lastX);H.isDragging=1;i(H.el).removeClass("moo-on");i(H.el).removeClass("moo-off");J.e.stopPropagation();if((K<=F)&&(K>-4)){H.x=K;i(I).translateFx({x:H.x,y:0},{transitionDuration:0})}});i(this.el).onDragEnd(function(J){J.e.stopPropagation();i(I).cleanFx();if(H._swipe!==0&&J.time<400){if(H._swipe===1){H.toggle(1)}else{H.toggle(0)}}else{if(H.isDragging===1){H.isDragging=0;if(H.x<(F/2)){H.toggle(0)}else{H.toggle(1)}}}})},toggle:function(G){var F=i(this.el);if(G!==undefined){this.value=+G}else{if(this.value===0){this.value=1}else{this.value=0}}if(this.value===0){F.removeClass("moo-on");F.setClass("moo-off")}else{F.removeClass("moo-off");F.setClass("moo-on")}this.input.value=this.value;if(typeof this.onChange==="function"){this.onChange()}},on:function(F,G){if(F==="change"){this.onChange=G}}};var t=function(F){var G=0,H=this.pseudoItems=[];this.input=F.el;this.value=[];i(this.input).hide();this._makeHTML();H=i(this.container).find("div");for(G=0;G<H.length;G++){this.pseudoItems.push({el:H[G],value:H[G].value,mooSelectIndex:G})}this._setTouchEvents();if(F.value!==undefined){this.selectByValue(F.value)}return this};t.prototype={_makeHTML:function(){this.el=document.createElement("div");this.el.innerHTML=E({template:D.checkbox,self:this});this.container=i(this.el).find("div")[0];this.input.parentElement.appendChild(this.el)},_setTouchEvents:function(){var F=this,G=0;for(G=0;G<this.pseudoItems.length;G++){i(this.pseudoItems[G].el).onTapEnd(function(K){var J=i(K.el),H=K.el.getAttribute("moo-foreach-index"),I=function(){if(J.hasClass("moo-active")){F.unselect(H)}else{F.select(H)}};if(i.context.userAgent==="android"){window.setTimeout(function(){I()},0)}else{I()}b(K)})}},select:function(F){if(this.value.indexOf(F)<0){this.value.push(F.toString());this.items[F].el.setAttribute("checked","checked");i(this.pseudoItems[F].el).setClass("moo-active");C(this)}},unselect:function(F){this.value.splice(this.value.indexOf(F),1);this.items[F].el.removeAttribute("checked","");i(this.pseudoItems[F].el).removeClass("moo-active");C(this)},unselectAll:function(){var F=0;for(F=this.items.length;F--;){this.unselect(F)}},selectByValue:function(H){var G,F;if(Object.prototype.toString.call(H)!=="[object Array]"){H=[H]}for(G=this.items.length;G--;){for(F=H.length;F--;){if(this.items[G].value===H[F]){i(this.pseudoItems[G].el).setClass("moo-active");this.select(G)}}}},onChange:function(F){if(m[this.input.id]===undefined){m[this.input.id]=[]}m[this.input.id].push(F)}};var m={},C;C=function(F){var G;if(m[F.input.id]!==undefined){for(G=m[F.input.id].length;G--;){m[F.input.id][G](F)}}};var v=function(F){var G=0,H=this.pseudoItems=[];this.input=F.el;i(this.input).hide();this._makeHTML();H=i(this.container).find("div");for(G=0;G<H.length;G++){this.pseudoItems.push({el:H[G],value:H[G].value,mooSelectIndex:G})}this._setTouchEvents();if(F.value!==undefined){this.selectByValue(F.value)}return this};v.prototype={_makeHTML:function(){this.el=document.createElement("div");this.el.innerHTML=E({template:D.radio,self:this});this.container=i(this.el).find("div")[0];this.input.parentElement.appendChild(this.el)},_setTouchEvents:function(){var F=this,G=0;for(G=0;G<this.pseudoItems.length;G++){i(this.pseudoItems[G].el).onTapEnd(function(H){b(H);F.select(H.el.getAttribute("moo-foreach-index"))})}},select:function(G){var F=this,H;for(H=0;H<F.pseudoItems.length;H++){i(F.pseudoItems[H].el).removeClass("moo-active");F.pseudoItems[H].el.removeAttribute("checked","checked")}i(F.pseudoItems[G].el).setClass("moo-active");this.value=this.items[G].value;this.selectedIndex=G;this.input.selectedIndex=G;this.items[this.selectedIndex].el.setAttribute("checked","checked")},selectByValue:function(G){var F;for(F=this.items.length;F--;){if(this.items[F].value===G){this.select(F)}}}};var r=function(F){var G=0,H=this.pseudoItems=[];this.y=0;this.input=F.el;this._visibility="hidden";this._makeHTML();this._setTouchEvents();H=i(this.input).find("option");for(G=0;G<H.length;G++){this.pseudoItems.push({el:H[G],mooSelectIndex:G})}if(F.value!==undefined){this.selectByValue(F.value)}this.select(0);return this};r.prototype={_makeHTML:function(){var H=document.createElement("div"),G=D.select,F=this.input.parentElement;H.innerHTML=E({template:G,self:this});this.el=H.firstChild;this.el.parentElement.insertBefore(this.input);F.appendChild(H);this.box=i(this.el).find(".moo-ui-select-menu")[0];this.textspan=i(this.el).find(".moo-ui-select-text")[0]},_setTouchEvents:function(){var F=this;i(this.input).onTapEnd(function(G){if(F._visibility!=="visible"){F.input.focus();F._visibility="visible"}});i(this.input).on("blur",function(){F._visibility="hidden"});i(this.input).on("change",function(){F.select(F.input.selectedIndex)});i(this.el).onDragStart(b)},select:function(G){var F=this;window.setTimeout(function(){i(F.box).hide();F._visibility="hidden"},100);this.value=this.pseudoItems[G].el.value;this.selectedIndex=G;this.input.selectedIndex=G;i(this.textspan).html(this.pseudoItems[G].el.innerText)},selectByValue:function(G){var F;for(F=this.pseudoItems.length;F--;){if(this.pseudoItems[F].el.value===G){this.select(F)}}}};var p=function(F){var G=0,H=this.pseudoItems=[];this.y=0;this.input=F.el;this._visibility="hidden";this._makeHTML();this._setTouchEvents();if(F.value!==undefined){this.value=F.value}return this};p.prototype={_makeHTML:function(){var H=document.createElement("div"),G=D.uidate,F=this.input.parentElement;H.innerHTML=E({template:G,self:this});this.el=H.firstChild;this.el.parentElement.insertBefore(this.input);F.appendChild(H);this.box=i(this.el).find(".moo-ui-select-menu")[0];this.textspan=i(this.el).find(".moo-ui-select-text")[0]},_setTouchEvents:function(){var F=this;i(this.input).onTapEnd(function(G){if(F._visibility!=="visible"){F.input.focus();F._visibility="visible"}});i(this.input).on("blur",function(){F._visibility="hidden"});i(this.el).onDragStart(b)},};var B=function(F){var G=0,H=this.pseudoItems=[];this.y=0;this.input=F.el;this._visibility="hidden";this._makeHTML();this._setTouchEvents();if(F.value!==undefined){this.value=F.value}return this};B.prototype={_makeHTML:function(){var H=document.createElement("div"),G=D.uitime,F=this.input.parentElement;H.innerHTML=E({template:G,self:this});this.el=H.firstChild;this.el.parentElement.insertBefore(this.input);F.appendChild(H);this.box=i(this.el).find(".moo-ui-select-menu")[0];this.textspan=i(this.el).find(".moo-ui-select-text")[0]},_setTouchEvents:function(){var F=this;i(this.input).onTapEnd(function(G){if(F._visibility!=="visible"){F.input.focus();F._visibility="visible"}});i(this.input).on("blur",function(){F._visibility="hidden"});i(this.el).onDragStart(b)},};var A=false,x=function(G){var F=this;this.el=this.input=G.el;if(G.value!==undefined){this.el.value=G.value}this.value=F.el.value;this._makeHTML();i(this.el).onDragStart(b);i(this.el).onTapEnd(function(H){H.el.focus();b(H)});i(this.cleanbox).onTapEnd(function(){F.clean()});this.el.onblur=function(){window.scrollTo(0,0)};return this};x.focused=false;x.prototype={_makeHTML:function(){var H,G=this.el.parentElement,F=this;this.cleanbox=document.createElement("div");this.cleanbox.innerHTML=D.text;H=document.createElement("div");i(H).setClass("moo-ui-text");H.appendChild(this.cleanbox);H.appendChild(this.input);i(this.input).on("keyup",function(I){F.value=F.input.value;if(typeof F.onChange==="function"){F.onChange()}});G.appendChild(H)},clean:function(){this.input.value="";this.input.focus()},on:function(F,G){if(F==="change"){this.onChange=G}}};var y=function(G){var F=this;this.el=this.input=G.el;if(G.value!==undefined){this.el.innerHTML=G.value}this.value=F.el.innerHTML;this._makeHTML();i(this.el).onDragStart(b);i(this.el).onTapEnd(function(H){H.el.focus();b(H)});return this};y.prototype={_makeHTML:function(){var H,G=this.el.parentElement,F=this;i(this.input).on("keyup",function(I){F.value=F.input.value});H=document.createElement("div");i(H).setClass("moo-ui-textarea");H.appendChild(this.input);G.appendChild(H)}};var k=function(F){this.input=F.el;this.position=F.position;this.count=0;k._makeHTML(F,this);k._setTouchEvents(this);k._initProperties(this,F);if(F.value!==undefined){this.value=F.value}else{this.value=[]}return this};k.prototype={show:function(){if(typeof this.onShowBox==="function"){this.onShowBox()}i(this.el).show();this._visibility="visible"},hide:function(){i(this.el).hide();this._visibility="hidden"},onShowBox:function(F){this.onShowBox=F},onCamera:function(F){this.onCamera=F},onSuccess:function(F){this.onSuccess=F},onFail:function(F){this.onFail=F},onChange:function(F){this.onChange=F},push:function(K){var F=document.createElement("div"),J,H=this,G,I;F.innerHTML=this.imageWrapper.outerHTML;G=i(F).find(".moo-image");J=G[0];J.setAttribute("moo-index",this.count);G=i(H.imageList).find("li");for(I=G.length;I--;){i(G[I].firstChild).removeClass("moo-active")}i(J).setClass("moo-active");H.itemSelected=this.count;i(J).onTapEnd(function(O){var N=i(O.el),M,L=i(H.imageList).find("li");if(N.hasClass("moo-active")===false){for(M=L.length;M--;){i(L[M].firstChild).removeClass("moo-active")}i(O.el).setClass("moo-active");H.itemSelected=O.el.getAttribute("moo-index")}});J.appendChild(K);this.value.push(K.getAttribute("src"));i(F.firstChild).show();this.imageList.appendChild(F.firstChild);i(this.el).removeClass("moo-empty");this.count++},clear:function(){var F=i(this.imageList).find("li"),G=0;for(G=F.length;G--;){this.imageList.removeChild(F[G])}this.count=0;this.value=[]},removeItem:function(G){var F=i(this.imageList).find("li"),H=0;console.log("remove item!");this.imageList.removeChild(F[H]);this.value.splice(G,1);this.count=F.length-1;if(typeof this.onChange==="function"){this.onChange(this,G)}i(F[this.count]).setClass("moo-active");this.itemSelected=this.count}};i.extend({_makeHTML:function(H,G){var I=document.createElement("div"),F;I.innerHTML=D.camera;G.el=I.firstChild;F=i(G.el);F.setClass("moo-empty");if(G.position==="top"){F.setClass("moo-top")}else{if(G.position==="bottom"){F.setClass("moo-bottom")}}G.takeButton=F.find(".moo-ui-add-new")[0];G.chooseButton=F.find(".moo-ui-add-filed")[0];if(H.labelTakeButton!==undefined){G.takeButton.innerHTML=H.labelTakeButton}if(H.labelChooseButton!==undefined){G.chooseButton.innerHTML=H.labelChooseButton}G.imageWrapper=F.find(".moo-image-wrapper")[0];G.imageList=F.find(".moo-image-list")[0];F.hide();G._visibility="hidden";G.input.appendChild(G.el);i(G.imageWrapper).hide()},_setTouchEvents:function(F){i(F.input).onTapEnd(function(){if(F._visibility==="hidden"){F.show()}else{F.hide()}});i(F.el).onTapEnd(function(){F.hide()});i(F.takeButton).onTapEnd(function(){k.camera(F)});i(F.chooseButton).onTapEnd(function(){k.camera(F,"album")})},_initProperties:function(F,G){F.quality=F.quality?F.quality:50;F.width=F.width?F.width:1024;F.height=F.height?F.height:768},camera:function(F,G){var H,I;if(typeof F.onCamera==="function"){F.onCamera()}if(F.disabled!==true){if(window.Camera!==undefined){if(G==="album"){H=window.Camera.PictureSourceType.SAVEDPHOTOALBUM}I=function(J){F.onSuccess(J)};navigator.camera.getPicture(I,F.onFail,{quality:F.quality,destinationType:window.Camera.DestinationType.FILE_URI,sourceType:H,targetWidth:F.width,targetHeight:F.height})}else{console.log("Not camera! using sample pic");F.onSuccess("img/temp/samplepic.jpg")}}}},k);var e=function(F){this.input=F.el;this.sourceType=F.sourceType;e._setTouchEvents(this);e._initProperties(this,F);if(F.value!==undefined){this.value=F.value}else{this.value=[]}return this};e.prototype={onCamera:function(F){this.onCamera=F},onSuccess:function(F){this.onSuccess=F},onFail:function(F){this.onFail=F},onChange:function(F){this.onChange=F},};i.extend({_setTouchEvents:function(F){if(F.sourceType==="album"){i(F.input).onTapEnd(function(){k.camera(F,"album")})}else{i(F.input).onTapEnd(function(){k.camera(F)})}},_initProperties:function(F,G){F.quality=F.quality?F.quality:50;F.width=F.width?F.width:1024;F.height=F.height?F.height:768},camera:function(F,G){var H,I;if(typeof F.onCamera==="function"){F.onCamera()}if(F.disabled!==true){if(window.Camera!==undefined){if(G==="album"){H=window.Camera.PictureSourceType.SAVEDPHOTOALBUM}I=function(J){F.onSuccess(J)};navigator.camera.getPicture(I,F.onFail,{quality:F.quality,destinationType:window.Camera.DestinationType.FILE_URI,sourceType:H,targetWidth:F.width,targetHeight:F.height})}else{console.log("Not camera! using sample pic");F.onSuccess("img/temp/samplepic.jpg")}}}},e);var h=function(G){var F=this;this.el=G.el;h._setTouchEvents(F);if(G.key!==undefined){F.key=G.key}else{F.key=""}F.onLoad=G.onLoad;h._includeScript(F.key,function(){h._API=google.maps;h._initProperties(F,G);h._initMap(F,G);if(typeof F.onLoad==="function"){F.onLoad()}return F})};h.prototype={addMarker:function(G){var F=new j(G,this.map);F.setMap(this);return this}};var j=function(G,I){var H,F=this;this.lat=G.lat;this.lon=G.lon;this.html=G.html;this._APIMarker=new h._API.Marker();this._APIMarker.setPosition(new h._API.LatLng(this.lat,this.lon));H=new h._API.InfoWindow({content:F.html});h._API.event.addListener(this._APIMarker,"click",function(){H.open(I,F._APIMarker)});return this};j.prototype={setMap:function(F){this._APIMarker.setMap(F.map)}};i.extend({_setTouchEvents:function(F){i(F.el).on("touchmove",function(G){G.stopPropagation()})},_initProperties:function(F,G){F.width=G.width?G.width:"100%";F.height=G.height?G.height:"100%";F.el.setAttribute("style","width:"+F.width+";height:"+F.height);F.zoom=G.zoom?G.zoom:13;F.center=G.center?G.center:[-34.599567,-58.372553];F.mapType=G.mapType?G.mapType:h._API.MapTypeId.ROADMAP},_includeScript:function(F,G){i._UIMapCallbacks=G;a(h._APIScript+"&key="+F)},_initMap:function(F){var G;G={zoom:F.zoom,center:new h._API.LatLng(F.center[0],F.center[1]),mapTypeId:F.mapType};F.map=new h._API.Map(F.el,G)},_APIScript:"https://maps.googleapis.com/maps/api/js?sensor=false&callback=$._UIMapCallbacks"},h);var a=function(F,H){var G=document.createElement("script");G.type="text/javascript";G.setAttribute("src",F);G.onload=H;document.body.appendChild(G)};var n=function(){};i.extend({ui:function(F){var G=n.get(this.query);if(G===undefined){F.el=this.el;switch(F.type){case"ToggleSwitch":G=new u(F);break;case"Text":G=new x(F);break;case"TextArea":G=new y(F);break;case"Select":G=new r(F);break;case"Radio":G=new v(F);break;case"Checkbox":G=new t(F);break;case"Camera":G=new k(F);break;case"SimpleCamera":G=new e(F);break;case"Map":G=new h(F);break;case"Date":G=new p(F);break;case"Time":G=new B(F);break}G.id=this.query;G.type=F.type;n.push(G);return G}else{return n.get(this.query)}}});var z={};i.extend({ui:{overlay:function(){return new o()},loading:function(){return new l()},modal:function(F){return new c()}}},i);i(document).ready(function(){var F=new o(),G=new l();i.extend({loadingScreen:{show:function(){F.show();G.show()},hide:function(){F.hide();G.hide()}}},i)});i.extend({_collection:[],get:function(G){var F;for(F=n._collection.length;F--;){if(n._collection[F].id===G){return n._collection[F]}}},push:function(F){this._collection.push(F)}},n);var b=function(F){F.e.stopPropagation();F.e.preventDefault()}}(Mootor));