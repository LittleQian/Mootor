(function(e){var a=function(i){a.init(i,this);this.header=new j(this);this.footer=new m(this);return this},c,f,n,k=[];a.prototype={el:undefined,set:function(o){var i=this.get(o);if(this._config.isMoving===false){this._config.isMoving=true;if(this.current!==i.index){this._config.back=this.current;if(this._config.direction===0){this.history.push(this.current)}this.current=i.index;a.load(this)}}return i},get:function(p){var o;for(o=this._config.count;o--;){if(this.items[o].el.id===p){return this.items[o]}}return null},goBack:function(){if(this.history.length>0){if(this._config.isMoving===false){this._config.direction=-1;this._config.back=this.history.pop();this.set(this.items[this._config.back].el.id)}}return this.items[this.current].index},handleGesture:function(i){a.handleGesture(i,this)}};c=function(i){this.el=i.el;this.id=this.el.id;this.index=i.index;this.height=i.height;this.x=i.x;this.y=i.y;return this};e.extend({getLinks:function(p,q){var o,s,r=[];o=e(p.el).find("."+q._config.navClass);for(s=0;s<o.length;s++){if(o[s].getAttribute("href").replace("#","")!==""){r.push(o[s])}}return r},loadNavigationItem:function(s,p,q){var r=0,o="";for(r=p.navigationItemsCount;r--;){e(p.navigationItems[r]).removeClass("active")}q._config.direction=0;if(q._config.isMoving===false){o=s.el.getAttribute("href");if(o&&o!==""){q.set(o.replace("#",""))}}},initNavigationItems:function(o,p){var r,q;o.navigationItems=c.getLinks(o,p);o.navigationItemsCount=o.navigationItems.length;for(q=o.navigationItemsCount;q--;){r=o.navigationItems[q];if(e(r).hasClass(p._config.navClass)===false){e(r).onTapEnd(function(i){window.location=i.el.href})}else{if(r.getAttribute("href").replace("#","")!==""){e(r).onTapStart(function(i){e(i.el).setClass("active")});e(r).onTapEnd(function(i){c.loadNavigationItem(i,o,p)})}}}o.initNavigation=function(){c.initNavigationItems(o,p)};return o}},c);e.extend({nav:function(i){var o;if(typeof i!=="object"){i={}}i.el=this.el;i._query=this.query;o=a.get(this.query);if(o===undefined){return new a(i)}else{return o}}});e.extend({_collection:[],init:function(o,i){i.el=o.el;i._options=o;a.initProperties(i,o);e(i.el).setClass(i._config.containerClassName);a.initItems(i);e(i.el).onDragMove(i);e(i.el).onDragEnd(i);a.initResizeEvents(i);return i},initProperties:function(i,o){var p;i._config={x:0,y:0,back:0,isMoving:false,direction:0,width:e.view.clientW,height:e.view.clientH,transitions:o.transitions,headerClassName:o.headerClassName?o.headerClassName:"moo-header",footerClassName:o.footerClassName?o.footerClassName:"moo-footer",navClass:o.navLinksClassName?o.navLinksClassName:"moo-nav",hiddenClassName:o.hiddenClassName?o.hiddenClassName:"moo-hidden",margin:o.margin?o.margin:5,containerClassName:o.containerClassName?o.containerClassName:"moo-panels",itemClass:o.itemsClassName?o.itemsClassName:"moo-panel",type:o.type?o.type:"Panels"};if(i._config.transitions===undefined){i._config.transitionDuration=0.25}else{i._config.transitionDuration=0}if(i._config.type==="Panels"){p=l}i._config.navItem=p;i.items=[];i.current=0;i.history=[];a._collection.push(i);i.id=o.id?o.id:o._query},handleGesture:function(o,i){o.e.preventDefault();switch(o.type){case"dragMove":a.move(o,i);break;case"dragEnd":i._config.navItem.checkMove(o,i);break}},nav:function(o,i){o._anchors=i.el.getElementsByClassName(i._options.navClass)},move:function(o,i){var p=i.items[i.current];if(o.isDraggingY!==0&&p.movable!==false){i._config.navItem.move(i,p,o)}},load:function(i){i._config.navItem.load(i)},initResizeEvents:function(i){e(window).bind("resize",function(){setTimeout(function(){if(i.header!==undefined){i._config.height=e.view.clientH-i.header.height}else{i._config.height=e.view.clientH}},1)})},initItems:function(o){var p,q,r=o.el.getElementsByClassName(o._config.itemClass);o.items=[];for(p=0;p<r.length;p++){q=new c({el:r[p],index:p,x:0,y:0});c.initNavigationItems(q,o);o.items.push(q)}o._config.count=p;a.initNavItemStyles(o)},initNavItemStyles:function(i){i._config.navItem.initStyles(i)},preventNativeScrolling:function(){e(document).ready(function(){e(document.body).bind("touchmove",function(i){i.preventDefault();i.stopPropagation()})})},get:function(i){return a._collection.map(function(o){if(o.id===i){return o}})[0]},_scrollBar:function(i){}},a);a.preventNativeScrolling();var j=function(i){this.el=e("header")[0];if(this.el!==undefined){this.height=this.el.offsetHeight;this.el.style.height=this.height+"px";d(this.height,i);e(this.el).setClass(i._config.headerClassName);j.initAnchorBack(this,i);j.initNavigationLinks(this,i);j.preventNativeScrolling(this);return this}else{return undefined}};j.prototype={setTitle:function(i){e(this.el).find("h1")[0].innerText=i}};e.extend({initAnchorBack:function(i,o){var p=o._config.anchorBack=e(e(i.el).find(".moo-nav-back")[0]);if(p.el!==undefined){p.hide();p.el.onclick=function(){return false};p.onTapEnd(function(q){o.goBack()})}},preventNativeScrolling:function(i){e(i.el).on("touchmove",function(o){o.preventDefault()})},initNavigationLinks:function(o,p){var r=e(o.el).find(".moo-nav"),q;for(q=r.length;q--;){e(r[q]).onTapEnd(function(i){c.loadNavigationItem(i,o,p)})}}},j);var d=function(o,p){var q;for(q=p._config.count;q--;){p.items[q].el.style.paddingTop=o+"px"}};var m=function(i){this.el=e("footer")[0];if(this.el!==undefined){var o=this;window.setTimeout(function(){o.height=o.el.offsetHeight;o.el.style.height=o.height+"px"},10);h(this,i);e(this.el).setClass(i._config.footerClassName);m.initNavigationLinks(this,i);m.preventNativeScrolling(this);return this}else{return undefined}};e.extend({preventNativeScrolling:function(i){e(i.el).on("touchmove",function(o){o.preventDefault()})},initNavigationLinks:function(o,p){var r=e(o.el).find(".moo-nav"),q;for(q=r.length;q--;){e(r[q]).onTapEnd(function(i){c.loadNavigationItem(i,o,p)})}}},m);var h=function(q,o){var p;for(p=o._config.count;p--;){o.items[p].el.style.paddingBottom=q.height+"px"}};var l=function(){},b=function(i){i.duration=i.duration?i.duration:0;i.callback=i.callback?i.callback:function(){};i.y=i.y?i.y:0;i.x=i.x?i.x:0;e(i.el).translateFx({y:i.y,x:i.x},{transitionDuration:i.duration,callback:i.callback})};var g=function(p,i,o){var q=p._config;e(o.el).hide();q.isMoving=false;i.x=0;q.x=0;b({el:p.el,x:0},p);b({el:i.el,x:0},p)};e.extend({load:function(u){var o,v,s,t,w,r,p=u._config,q;o=u.items[u.current];s=u.items[p.back];e(o.el).show();t=p.width+p.margin;if(u.current!==0){p.anchorBack.show()}else{p.anchorBack.hide()}if(p.direction===0||p.back===0){b({el:o.el,x:t},u);o.x=t;t=-t}else{b({el:o.el,x:-t},u);o.x=-t;t=t}window.setTimeout(function(){b({el:u.el,duration:p.transitionDuration,x:t,callback:function(){g(u,o,s)}},u)},1);if(typeof o.onLoad==="function"){o.onLoad()}},initStyles:function(o){var p=0,q={};for(p=o._config.count;p--;){q=o.items[p];if(p>0){b({el:q.el,x:-((o._config.width+o._config.margin)*4),y:0},o);e(q.el).hide()}else{b({el:q.el,x:0},o)}q.height=q.el.offsetHeight;if(o._config.height>q.height){q.height=o._config.height}}},checkMove:function(r,p){var o=p.items[p.current],s=o.height-p._config.height,q;if(p.header!==undefined){s+=p.header.height}if(r.type==="dragEnd"){if(p._config.y>=0||s<-p._config.y){if(p._config.y>0){p._config.y=0}else{p._config.y=-s}for(q=o.navigationItems.length;q--;){e(o.navigationItems[q]).removeClass("active")}b({y:p._config.y,el:o.el,duration:0.25},p)}}},move:function(q,t,s){var o=false;q._config.y=q._config.y+(s.y-s.lastY);var p=q.items[q.current],u=p.height-q._config.height,r;if(q.header!==undefined){u+=q.header.height}if(q._config.transitions===false){if(q._config.y<0&&u>-q._config.y){o=true}}else{o=true}if(o===true){b({el:t.el,y:q._config.y,x:t.x},q)}},setStylesWhenHeaderOrFooterIsActive:function(o,p){var q;for(q=p._config.count;q--;){p.items[q].el.style.paddingTop=o+"px"}}},l)}(Mootor));