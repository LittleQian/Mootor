(function(e){var a,c;a=function(m){var l=this;if(m.noInit!==true){a.init(m,this);this.header=new h(this);this.footer=new j(this)}else{this.init=function(){a.init(m,l)}}};a.prototype={el:undefined,set:function(m){var l=this.get(m);if(l!==null){if(this._config.isMoving===false){this._config.isMoving=true;if(this.current!==l.index){this._config.back=this.current;if(this._config.direction===0){this.history.push(this.current)}this.current=l.index;a.load(this)}}}return l},get:function(m){var l;for(l=this._config.count;l--;){if(this.items[l].el.id===m){return this.items[l]}}return null},goBack:function(){if(this.history.length>0){if(this._config.isMoving===false){this._config.direction=-1;this._config.back=this.history.pop();this.set(this.items[this._config.back].el.id)}}return this.items[this.current].index},handleGesture:function(l){a.handleGesture(l,this)}};c=function(l){this.el=l.el;this.id=this.el.id;this.index=l.index;this.height=l.height;this.x=l.x;this.y=l.y;return this};e.extend({getLinks:function(m,n){var l,p,o=[];l=e(m.el).find("."+n._config.navClass);for(p=0;p<l.length;p++){if(l[p].getAttribute("href").replace("#","")!==""){o.push(l[p])}}return o},loadNavigationItem:function(p,m,n){var o=0,l="";for(o=m.navigationItemsCount;o--;){e(m.navigationItems[o]).removeClass("active")}n._config.direction=0;if(n._config.isMoving===false){l=p.el.getAttribute("href");if(l&&l!==""){p.e.stopPropagation();p.e.preventDefault();n.set(l.replace("#",""))}}},initNavigationItems:function(l,m){var o,n;l.navigationItems=c.getLinks(l,m);l.navigationItemsCount=l.navigationItems.length;for(n=l.navigationItemsCount;n--;){o=l.navigationItems[n];if(e(o).hasClass(m._config.navClass)===false){e(o).onTapEnd(function(p){window.location=p.el.href})}else{if(o.getAttribute("href").replace("#","")!==""){e(o).onTapStart(function(p){e(p.el).setClass("active")});e(o).onTapEnd(function(p){c.loadNavigationItem(p,l,m)})}}}l.initNavigation=function(){c.initNavigationItems(l,m)};return l}},c);e.extend({nav:function(l){var m;if(typeof l!=="object"){l={}}l.el=this.el;l._query=this.query;m=a.get(this.query);if(m===undefined){return new a(l)}else{return m}}});e.extend({_collection:[],init:function(m,l){l.el=m.el;l._options=m;a.initProperties(l,m);e(l.el).setClass(l._config.containerClassName);a.initItems(l);e(l.el).onDragMove(l);e(l.el).onDragEnd(l);a.initResizeEvents(l);return l},initProperties:function(l,m){var n;l._config={x:0,y:0,back:0,isMoving:false,direction:0,width:e.view.clientW,height:e.view.clientH,transitions:m.transitions,boosting:m.boosting,headerClassName:m.headerClassName?m.headerClassName:"moo-header",footerClassName:m.footerClassName?m.footerClassName:"moo-footer",navClass:m.navLinksClassName?m.navLinksClassName:"moo-nav",hiddenClassName:m.hiddenClassName?m.hiddenClassName:"moo-hidden",margin:m.margin?m.margin:5,containerClassName:m.containerClassName?m.containerClassName:"moo-panels",itemClass:m.itemsClassName?m.itemsClassName:"moo-panel",type:m.type?m.type:"Panels"};if(l._config.transitions===undefined){l._config.transitionDuration=0.25}else{l._config.transitionDuration=0}if(l._config.type==="Panels"){n=i}l._config.navItem=n;l.items=[];l.current=0;l.history=[];l.id=m.id?m.id:m._query;if(a.get(l.id)===undefined){a._collection.push(l)}},handleGesture:function(m,l){m.e.preventDefault();switch(m.type){case"dragMove":a.move(m,l);break;case"dragEnd":l._config.navItem.checkMove(m,l);break}},nav:function(m,l){m._anchors=l.el.getElementsByClassName(l._options.navClass)},move:function(m,l){var n=l.items[l.current];if(m.isDraggingY!==0&&n.movable!==false){l._config.navItem.move(l,n,m)}},load:function(l){l._config.navItem.load(l)},initResizeEvents:function(l){e(window).bind("resize",function(){setTimeout(function(){if(l.header!==undefined){l._config.height=e.view.clientH-l.header.height}else{l._config.height=e.view.clientH}},1)})},initItems:function(l){var m,n,o=l.el.getElementsByClassName(l._config.itemClass);l.items=[];for(m=0;m<o.length;m++){n=new c({el:o[m],index:m,x:0,y:0});c.initNavigationItems(n,l);l.items.push(n)}l._config.count=m;a.initNavItemStyles(l)},initNavItemStyles:function(l){l._config.navItem.initStyles(l)},preventNativeScrolling:function(){e(document).ready(function(){e(document.body).bind("touchmove",function(l){l.preventDefault();l.stopPropagation()})})},get:function(l){return a._collection.map(function(m){if(m.id===l){return m}})[0]},_scrollBar:function(l){}},a);window._navCollection=a._collection;a.preventNativeScrolling();var k=function(l){this.$el=e(l);this.id=l.id;return this};k.prototype={hide:function(){this.$el.removeClass("moo-visible")},show:function(){this.$el.setClass("moo-visible")}};window.addEventListener("load",function(){setTimeout(function(){window.scrollTo(1,0)},300)});var h=function(l){this.el=e("header")[0];if(this.el!==undefined){this.height=this.el.offsetHeight;d(this.height,l);e(this.el).setClass(l._config.headerClassName);h.initAnchorBack(this,l);h.initNavigationLinks(this,l);h.preventNativeScrolling(this);return this}else{return undefined}};h.prototype={setTitle:function(l){e(this.el).find("h1")[0].innerText=l}};e.extend({initAnchorBack:function(l,m){var n=m._config.anchorBack=e(e(l.el).find(".moo-nav-back")[0]);m._config.anchorBack.show=function(){this.setClass("moo-visible")};m._config.anchorBack.hide=function(){this.removeClass("moo-visible")};n.onTapStart(function(){n.setClass("moo-hover")});n.onTapEnd(function(){n.removeClass("moo-hover")});if(n.el!==undefined){n.hide();n.el.onclick=function(){return false};n.onTapEnd(function(o){m.goBack()})}},preventNativeScrolling:function(l){e(l.el).on("touchmove",function(m){m.preventDefault()})},initNavigationLinks:function(m,n){var p=e(m.el).find(".moo-nav"),q,o,l;m.navLinks={};for(o=p.length;o--;){q=e(p[o]);q.onTapEnd(function(r){c.loadNavigationItem(r,m,n)});l=new k(p[o]);m.navLinks[l.id]=l;q.onTapStart(function(r){e(r.el).setClass("moo-hover")});q.onTapEnd(function(r){e(r.el).removeClass("moo-hover")})}}},h);var d=function(l,m){var n;for(n=m._config.count;n--;){m.items[n].el.style.paddingTop=l+"px"}};var j=function(l){this.el=e("footer")[0];if(this.el!==undefined){this.height=this.el.offsetHeight;g(this,l);e(this.el).setClass(l._config.footerClassName);j.initNavigationLinks(this,l);j.preventNativeScrolling(this);return this}else{return undefined}};e.extend({preventNativeScrolling:function(l){e(l.el).on("touchmove",function(m){m.preventDefault()})},initNavigationLinks:function(l,m){var o=e(l.el).find(".moo-nav"),p,n;for(n=o.length;n--;){p=e(o[n]);p.onTapEnd(function(q){var r=m.get(q.el.getAttribute("href").replace("#",""));if(r.index!=m.current){c.loadNavigationItem(q,l,m)}});p.onTapStart(function(q){e(q.el).setClass("moo-hover")});p.onTapEnd(function(q){e(q.el).removeClass("moo-hover")})}}},j);var g=function(n,l){var m;for(m=l._config.count;m--;){l.items[m].el.style.paddingBottom=n.height+"px"}};var i=function(){},b=function(l){l.duration=l.duration?l.duration:0;l.callback=l.callback?l.callback:function(){};l.y=l.y?l.y:0;l.x=l.x?l.x:0;e(l.el).translateFx({y:l.y,x:l.x},{transitionDuration:l.duration,callback:l.callback})};var f=function(n,l,m){var o=n._config;e(m.el).hide();o.isMoving=false;l.x=0;o.x=0;b({el:n.el,x:0},n);b({el:l.el,x:0},n);if(typeof l.onLoad==="function"){l.onLoad();l.height=l.el.offsetHeight}};e.extend({load:function(o){var l,s,m,q,p,n=o._config,r;l=o.items[o.current];m=o.items[n.back];e(l.el).show();if(n.anchorBack!==undefined){if(o.current!==0){n.anchorBack.show()}else{n.anchorBack.hide()}}if(n.transitionDuration>0){q=n.width+n.margin;if(n.direction===0||n.back===0){b({el:l.el,x:q},o);l.x=q;q=-q}else{b({el:l.el,x:-q},o);l.x=-q;q=q}n.y=0;window.setTimeout(function(){b({el:o.el,duration:n.transitionDuration,x:q,callback:function(){f(o,l,m)}},o)},1)}else{f(o,l,m)}},initStyles:function(l){var m=0,n={},o;for(m=l._config.count;m--;){n=l.items[m];if(l._config.transitionDuration>0){if(m>0){b({el:n.el,x:-((l._config.width+l._config.margin)*4),y:0},l)}else{b({el:n.el,x:0},l)}}if(m>0){e(n.el).hide()}n.height=n.el.offsetHeight;if(l._config.height>n.height){n.height=l._config.height}}o=function(){var p=e.view.clientW+"px";for(m=l._config.count;m--;){n.el.style.width=p}l.el.style.width=p;document.body.style.width=p};o();e(window).on("resize",o)},checkMove:function(q,m){var l=m.items[m.current],s=l.height-m._config.height,r,n,p,o;if(m.header!==undefined){s+=m.header.height}if(q.type==="dragEnd"){if(m._config.y>=0||s<-m._config.y){if(m._config.y>0){m._config.y=0}else{m._config.y=-s}for(o=l.navigationItems.length;o--;){e(l.navigationItems[o]).removeClass("active")}b({y:m._config.y,el:l.el,duration:0.25},m)}else{if(m._config.boosting!==false){r=q.velocity.y*1000;p=Math.abs(r);if(p<25){n=0}else{if(p<50){n=100}else{if(p<500){n=500}else{if(p<1000){n=1000}else{if(p<2000){n=3000}else{n=5000}}}}}r=n*(r/p);m._config.y-=r;if(m._config.y>=0||s<-m._config.y){if(m._config.y>0){m._config.y=0}else{m._config.y=-s}}b({y:m._config.y,el:l.el,duration:1,},m)}}}},move:function(n,q,p){var l=false;q.y=n._config.y=n._config.y+(p.y-p.lastY);var m=n.items[n.current],r=m.height-n._config.height,o;if(n.header!==undefined){r+=n.header.height}if(n._config.transitions===false){if(n._config.y<0&&r>-n._config.y){l=true}}else{l=true}q.maxdist=r;if(l===true){b({el:q.el,y:q.y,x:q.x},n)}},setStylesWhenHeaderOrFooterIsActive:function(l,m){var n;for(n=m._config.count;n--;){m.items[n].el.style.paddingTop=l+"px"}}},i)}(Mootor));